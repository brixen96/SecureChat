<div class="menu-container">
	<div class="menu-header">
		<div>
			<h1 class="menu-title">
				<i class="bi bi-card-list"></i>
				Menu Management
			</h1>
			<p class="menu-subtitle">Manage your products</p>
		</div>
		<div class="header-actions">
			<a routerLink="/admin/users" class="btn btn-outline-primary me-2">
				<i class="bi bi-arrow-left me-2"></i>
				Back to Users
			</a>
			<button class="btn btn-primary" (click)="showAddProductForm()">
				<i class="bi bi-plus-circle me-2"></i>
				Add Product
			</button>
		</div>
	</div>

	@if (error()) {
		<div class="alert alert-danger alert-dismissible" role="alert">
			<i class="bi bi-exclamation-triangle me-2"></i>
			{{ error() }}
			<button type="button" class="btn-close" (click)="error.set(null)"></button>
		</div>
	}

	<!-- Add/Edit Product Form -->
	@if (showAddForm()) {
		<div class="product-form-card">
			<div class="form-header">
				<h3>
					@if (editingProduct()) {
						<i class="bi bi-pencil me-2"></i>
						Edit Product
					} @else {
						<i class="bi bi-plus-circle me-2"></i>
						Add New Product
					}
				</h3>
				<button class="btn-close" (click)="hideForm()"></button>
			</div>

			<form [formGroup]="productForm" (ngSubmit)="saveProduct()">
				<div class="mb-3">
					<label for="productName" class="form-label">Product Name</label>
					<input
						type="text"
						class="form-control"
						id="productName"
						formControlName="name"
						placeholder="Enter product name"
						[class.is-invalid]="productForm.get('name')?.invalid && productForm.get('name')?.touched"
					/>
					@if (productForm.get('name')?.invalid && productForm.get('name')?.touched) {
						<div class="invalid-feedback">Product name is required</div>
					}
				</div>

				<div class="mb-3">
					<label for="productPrice" class="form-label">Price (DKK)</label>
					<input
						type="number"
						step="0.01"
						min="0.01"
						class="form-control"
						id="productPrice"
						formControlName="price"
						placeholder="0.00"
						[class.is-invalid]="productForm.get('price')?.invalid && productForm.get('price')?.touched"
					/>
					@if (productForm.get('price')?.invalid && productForm.get('price')?.touched) {
						<div class="invalid-feedback">Price must be greater than 0</div>
					}
				</div>

				<div class="form-actions">
					<button type="button" class="btn btn-secondary" (click)="hideForm()">Cancel</button>
					<button type="submit" class="btn btn-primary" [disabled]="productForm.invalid || saving()">
						@if (saving()) {
							<span class="spinner-border spinner-border-sm me-2"></span>
							Saving...
						} @else {
							@if (editingProduct()) {
								Update Product
							} @else {
								Add Product
							}
						}
					</button>
				</div>
			</form>
		</div>
	}

	@if (loading()) {
		<div class="loading-container">
			<div class="spinner-border text-primary" role="status">
				<span class="visually-hidden">Loading...</span>
			</div>
			<p class="loading-text">Loading products...</p>
		</div>
	}

	@if (!loading()) {
		@if (products().length === 0) {
			<div class="empty-state">
				<i class="bi bi-inbox"></i>
				<p>No products yet</p>
				<button class="btn btn-primary" (click)="showAddProductForm()">
					<i class="bi bi-plus-circle me-2"></i>
					Add Your First Product
				</button>
			</div>
		} @else {
			<div class="products-list">
				@for (product of products(); track product.id) {
					<div class="product-item">
						<div class="product-icon">
							<i class="bi bi-bag-fill"></i>
						</div>
						<div class="product-info">
							<h3 class="product-name">{{ product.name }}</h3>
							<p class="product-price">{{ formatPrice(product.price) }} DKK</p>
						</div>
						<div class="product-actions">
							<button class="btn btn-sm btn-outline-primary" (click)="editProduct(product)" title="Edit product">
								<i class="bi bi-pencil"></i>
							</button>
							<button class="btn btn-sm btn-outline-danger" (click)="deleteProduct(product)" title="Delete product">
								<i class="bi bi-trash"></i>
							</button>
						</div>
					</div>
				}
			</div>
		}
	}
</div>
